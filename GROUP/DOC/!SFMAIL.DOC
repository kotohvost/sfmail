













                                                         ╬╬

           ╔╬═══╬╣  ╬╬═══╬╣           ╬╬╗  ╔╬╬   ╔╬═╬╗   ╬╬  ╬╬
           ║║       ║║                ║║╚╗╔╝║║   ║║ ║║   ║║  ║║
           ╚╬═══╬╗  ╬╬═╬╣    ╠╬═══╬╣  ║║ ╚╝ ║║  ╔╬╩═╩╬╗  ║║  ║║
                ║║  ║║                ║║    ║║  ║║   ║║  ║║  ║║
           ╠╬═══╬╝  ╬╬                ╬╬    ╬╬  ╬╬   ╬╬  ╬╬  ╬╬═══╬╣











                         Santa Fox Mail System

                 (C)opyright 1994-95 by Santa Fox Team.





















                           St-Petersburg
                               1995










          Данная версия мейлера SF-Mail 1.03 является некоммерческим
        продуктом.  Все права защищены в соответствии  с законом об
        авторском праве.  SF-Mail поставляется  в виде "As Is" (как
        есть), и авторы не несут никакой ответсвенности за происшедшее
        по вине мейлера на вашей системе. Гарантируется только то, что
        SF-Mail будет занимать пространство на вашем жестком диске :)
        Никакая часть SF-Mail-а не может быть изменена, в каком
        бы то не было виде, без предварительного согласия с авторами
        мейлера.
          SF-Mail является торговым коммерческим названием мейлера,
        написанным командой програмистов "Santa Fox Team". Любое
        изменение названия, а так же плагиаты, будут считаться нарушением
        авторских прав и будут преследоваться в соотвествии с
        законом об авторских правах.
          Вы можете свободно распространять и копировать без ограничений
        некоммерческие версии SF-Mail-а.
          Техническая поддержка и консультации оказываются только
        зарегестрированным пользователям.
          SF-Mail является FTN-мейлером, поэтому он имеет возможность
        использоваться во всех сетях и со всеми мейлерами, работающими
        по аналогичному стандарту.
          SF-Mail является в своем роде уникальным мейлером, имеющим
        достаточно большие возможности, и включающий в себя следующие
        отличительные особенности:

        - Классический интеpфейс, немного напоминающий интерфейс
          FrontDoor, наиболее оптимальный с эргономической точки зрения,
          по  нашему мнению.:)
        - Автономная система Inside ArcMail Attach.
        - Распознаются и используются ноделистовые временные флаги Txy,
          а так же флаги OH: и FR:.
        - Наличие мощной системы определения ресурсов системы, под
          которой работает в данный момент мейлер. Определение используется
          с целью оптимального использования ресурсов системы. Пожалуй,
          ни один из существующих мейлеров не потребляет в ДОС окне
          под OS/2 так мало ресурсов, как SF-Mail.
        - Умеет запускать внешние пpиложения сам, при помощи заранее
          заданный настроек в сетапе, как в одиночном окне под ДОС-ом,
          так и в фоновом режиме, если используется мультизадачная
          ОС как например OS/2, DV, WIN/WIN95.
        - Уникальная система свопинга, применяемая в мейлере, (XMS/EMS/
          EXT/HDD), позволяет очень гибко и незаметно манипулировать
          запуском различных внешних приложений.
        - Уникальный ZModem, написанный с нуля, с поддеpжкой не стандаpтных
          блоков pазмеpом до 16k;)
        - Встроенный терминал, с возможностью подключения внешней термиальной
          программы. Терминал автоматически  распознает и поддерживает
          системы TTY/ANSI/AVATAR, использует ZModem, имеет систему
          автодозвона.
        - Гибкая система обработки входных звонков, позволяющая адекватно
          обрабатывать входящие и выходящие звонки.
        - Очень высокая скорость обработки EMSI-пакета. Адаптивное
          подстраивание под "особенности" мейлера, с которым проходит
          сессия.
        - Мощная система обработки файловых запростов. Автономная обработка
          ограничений, а так же допускаются кроме запросов по имени и алиасу,
          запароленные запросы к парольным директориям и полнопутевые запросы
          при установленом пароле в SF-сервере.
        - Система распознавания и приема факсов.
        - Система распозования голосовых сообщений и запуск автономный старт
          автоответчика.


                                        (С)Santa Fox Team, 1994-1995






                               ОГЛАВЛЕНИЕ

    1. Введение .................................................

    2. Конфигурирование системы
        2.1  Требования к аппаратным средствам ..................
        2.2  Требования к программным средствам .................
        2.3  Системные каталоги .................................
        2.4  Конфигурационные файлы .............................
           2.4.1  Общие соглашения ..............................
           2.4.2  SF-MAIL.CFG ...................................
           2.4.3  ROUTE.CTL .....................................
           2.4.4  SUBST.CTL .....................................
           2.4.5  PROCESS.CTL ...................................
           2.4.6  ANC.CTL .......................................
        2.5  Внешние утилиты ....................................
           2.5.1  SFMATTCH.EXE ..................................
           2.5.2  SF-ARC.EXE ....................................
    3. А как оно работает? (Интерфейс SF-Mail) ..................
        3.1  Предварительные  приготовления......................
           3.1.1  FOSSIL и что с ним делать .....................



        3.9  Функциональные клавиши .............................


    4. Работа под мультизадачными ОС ............................
        4.1 Общий обзор .........................................




/*
        7 События...........................
            7.1 Администратор События...................
                7.1.1 Внешнее поведение события.............
                7.1.2 Поведение события Почты...............
                7.1.3 Событие...................
                7.1.4 Перекрывание событий...............

        8 Mailer...........................
            8.1 Меню.........................
                8.1.1 Программы <Alt-P>................
                8.1.2 Утилиты <Alt-U>................
                8.1.3 Почта <Alt-U>..................
            8.2 Очередь Почты <Alt-B>..................
            8.3 Прогресс Обращения.....................
            8.4 Индикаторы Семафора.................
            8.5 Undialable......................

        10 Терминал..........................
            10.1 Меню........................
            10.8 Передачи Файла....................
            10.9 Интерактивный таймер....................


        11 Разнообразный.......................

        12 Запросы Файла.......................
            12.1 Экспортные Запросы..................
            12.2 Запрос файлов с паролем...........
            12.3 Запросы Модификации...................
            12.4 Inbound Запросы...................


        14  Операционные среды.....................

        24 Командные Файлы........................
            24.1 Уровни Ошибки.....................
            24.2 Категории......................

*/



                         I. Введение.

 Прежде чем приступить к описанию мейлера в целом, желательно
преварительно сказать несколько слов о нем. Во-первых - не торопитесь
сразу влоб запускать мейлер. Практически с вероятностью 99% у вас
ничего не получится. Сядьте, спокойно пробегите доку глазами, благо
она на русском :)  В SF-Mail использованы уникальные особенности, о
которых вы можете узнать только после того, как прочитаете данный
документ. В первую очередь это касается начинающих, ежедневно втекающих
с компьютерные сети. В расчет на них писалась эта дока. То есть даже
начинающий может без посторонней помощи, с помощью данного документа,
самостоятельно разобраться и настроить мейлер.

  Итак начнем! :)  Данный программный продукт является мейлером.
Мейлер - это такая штуковина, которая сильно упрощает жизнь сисопу,
системному оператору почтовой станции, и даже грубо говоря делает за
него практически все.  Это как бы почтовый робот, способный принимать и
отправлять почту, а так же заставляющий другие программы обрабатывать
ее. Мейлер - это программа реального времени, исполняющая то или иное в
зависимости от времени суток.  На сегодняшний день существует достаточно
пестрая коллекция мейлеров. Мы постарались взять самые вкусные особенности
существующих мейлеров, и обойти те неразрешимые проблемы, которые
считаются камнем преткновения в других мейлерах. На наш взгляд нам это
удалось:) Во всяком случае нам хотелось бы на это надеяться.
Четыре принципа, которыми мы старались руководствоваться в процессе
написания мейлера: компактность, скорость, простота в настройке и
надежность.
 Мы очень надеемся, что наше творчество доставит вам массу приятного
и освободившегося времени :)
 Хотим так же выразить свою искринюю признательность группе поддержки и
бета-тестерам, благодаря которым, было найдено и исправлено много ошибок,
а так же принято много интересных предложений и рекомендаций. Но чтобы
никого из них не обидеть, мы не будем упоминать никого конкретно.
Скажем только, что мы очень благодарны за интерес и терпение. :)


                    !!! КАК С НАМИ СВЯЗАТЬСЯ !!!:

 Пожалуй - это единственный на сегодняшний день способ - через FidoNet.
Ну если вы не имеете пока к этому отношения ( тогда зачем вам мейлер? :),
то передайте свое сообщение через ваших друзей-фидошников.

1) Vadim Baranovsky  2:5030/142.15@fidoNet, (AKA 2:5030/103.4@fidoNet,
                     135:7000/4.1@OOpsNet);
2) Anton Deinow      2:5030/143@fidoNet (AKA 135:7000/555@OOpsNet);
3) Alexey Solomonov  2:5030/142@fidoNet (AKA 135:7000/4@OOpsNet).
4) Konstantin Kozlov 2:5030/103@fidonet (АКА 322:223/9@barbynet,
                     101:3000/101.5@chatuenet)









  ╔═════════════════════════════════════════════════════════════════════╗
  ║    ▒▒▒▒▓▓▓▓░░░░░░   2. КОНФИГУРИРОВАНИЕ СИСТЕМЫ   ░░░░░░▓▓▓▓▒▒▒▒    ║
  ╚═════════════════════════════════════════════════════════════════════╝


                2.1 ТРЕБОВАНИЯ, ПРЕДЪЯВЛЯЕМЫЕ К КОМПЬЮТЕРУ,
                           ПРИ ПОЛЬЗОВАНИИ SF-MAIL.
                ===========================================


 Минимальные требования, которые требуются для пользования SF-Mail
 таковы:
   - IBM-совместимый компьютер на базе x86 процессора (286,
     386, 486, Pentium).
   - Монитор любой. (MVGA, CGA, EGA, VGA,
     SVGA).
   - HDD (Жесткий диск) может отсутствовать. Допускается
     работа на дискетах :) Обьем дискового простарнства, занимаемого
     SF-Mail-ом в минимальной конфигурации, не более 1 Мб.
!!!   - RAM (Оперативная память) - 400кб минимум, 1 Мб желательно.
   - Modem (Модем) Любой HAIES-совместимый. Он должен быть установлен
     на один из свободных COM-портов. Если модем внешний, и при этом
     скоростник, желательно использовать портовую плату с буфером
     FIFO16550.



            2.2 ТРЕБОВАНИЯ, ПРЕДЪЯВЛЯЕМЫЕ К ПРОГРАММНОМУ
                 ОБЕСПЕЧЕНИЮ, ПРИ ПОЛЬЗОВАНИИ  SF-MAIL.
            ============================================


  1. SF-Mail успешно и беспроблемно работает под следующими
     операционными средами:
     - MS-DOS (v.3.3 - 6.22)
     - Novell DOS (v.5.0 - 7.0)
     - OS/2 v.2.1 и старше
     - MS Windoze v3.1, v3.11
     - WIN'95
     - DesqView 2.60 и старше.

  2. Очень предпочтительно иметь EMS (EMM386.SYS) или XMS (HIMEM.SYS)
  память, поскольку в этом случае она будет использоваться мейлером для
!!!  свопинга и закидывания в нее овеpлея.



                       2.3 СИСТЕМНЫЕ КАТАЛОГИ
                      ========================
!!! Это то для чего??? Вообще не понятно, каталоги можно называть как хочешь,
    так что тут какое-то не соответствие, а вообще начинать надо было не с
    этого, а с Основного конфигуpационного файла, и постепенно пеpеходить к
    остальным.
    Плюс описать пеpед этим общую концепцию FTN сетей.

   SF-Mail использует для себя следующие каталоги:

 1. BOXES
   Данный каталог предназначен для использованияп под так называемые файлбоксы.
   В этом каталоге...

!!! - нафиг? 2. FOSSIL
   Это отнюдь не обязательный каталог, но настоятельно рекомендуемый.
   В силу того, что фоссилы в своей поставке помимо основных файлов
    включают еще несколько утилит, то имеет смысл сделать отдельный
    директорий для фоссила.

 3. FLAGS
   В этом каталоге хранятся внешние и внутренние флаги мейлера,
    которыми пользуется сам мейлер, и которые можно использовать для
    своих приложений. Для более детального ознакомдение с флагами,
    смотрите главу $$$$$, в которой подробно описываются эти флаги.

 4. PACKETS
    Это целиком служебный диреторий. В нем мейлер хранит очередь
    почтовых пакетов (А НЕ САМИ ПАКЕТЫ, как может показаться).
    !!! Сами пакеты тоже!
    В любом случае внешнее вмешательство в структуру этого каталога
    крайне нежелетельно. Однако, если все же случилось такое, что
    привело в уничтожению, или порче данного каталога, то настоятельно
    рекомендуется запустить повторно мейлер и инициировать перепаковку
    почты ( ALT-Y ).
    !!! Или стеpеть его полностью! Тогда SF-Mail сам заново пеpепакует почту.

!!! Он ли? SF-Arc - это эхо пила! А SFMATTCH - лежит в основном каталоге SF-Mail'а
 5. SF-ARC
    В этом каталоге находится программа SF-Attach. Она позволяет без
    использования почтового редактора и мейлера, передать файл(ы) другим
    почтовым узлам. По сравнению со стандартной схемой, использование
    файл-боксов несомненно упращается передачу файлов другим узлам как
    в автоматическом режиме, так и при передаче файлов самостоятельно.

 6. NODELIST
    В этом каталоге будет находится ноделисты, то есть те файлы,
    которые отвечают за информацию о других узлах. В том же директории
    находится служебный файл, в котором осуществляется конфигурация
    окружения для компиляции ноделиста в тот формат, который понимает
    SF-Mail.

7.  FILES. Это обязательный диреторий, который должен быть. Он может
    называться совершено произвольно. Важно то, что присутствие его
    обязательно :). В него будут приходить и сваливаться почтовый
    пакеты и файлы. Вообщем, это входной директорий. :)

8.  LOG. Директорий не является обязательным. В нем будет храниться
    файл sf-mail.log, в котором  будет помещаться вся информация о том,
    что делает мейлер. В конфигурационном файле sf-mail.cfg должны быть
    прописаны имя и путь до этого директория.




                   2.4.1 ОБЩИЕ СОГЛАШЕНИЯ
                   ----------------------

  Есть необходимость сказать об общепринятых соглашениях, присутствующих
во всех текстовых системных конфигах SF-Mail.

 Параметры от условных слов могут разделяться произвольным количеством
!!! пробелов, не превышающих число 255. Важно, что бы это все находилось в
одной строке. !!! За исключением Subst.ctl, где слиянием стpок считаеться
знак '+'

 Время обозначается следующим образом:
!!! [start_Day_Of_Week.]start_time-[end_Day_Of_Week.]end_time
Пpимеp: ...

 Бинарные значения Yes/No


 Макросы, определяемые условным словом #define


 Подключение внешних конфигов через условное слово #include


 Флаги, по FTN технологии.





                 2.4.2 ОПИСАНИЕ SF-MAIL.CFG
                ----------------------------

 Конфигурационный файл SF-MAIL.CFG состоит из разделов, выделенных в
квадратные скобки []. Внутри каждого раздела находятся ключевые слова.
Любые другие коментарии могут находиться между служебными словами, но
при этом они должны быть закомментированы в начале строки знаком ";".
Каждый раздел имеет свой набоp ключевых слов, котоpые он способен
распознать. Если внутри раздела встpечается неизвестное ключевое
слово, то компилляция пpекpащается и выдается сообщение об ошибке.


                     1. Раздел [System]
                     ------------------

   Task  <Num>

  Используется в мультизадачных операционных средах. Определяет номер
линии, по которой ведется прием-передача файлов. В однозадачных ОС
всегда равен нулю.  При помощи этого параметра сделана развязка по
линиям. Значение этого параметра выведено в основное окно мейлера в
нижнем левом углу.

Пример:  Task  0



  Overlay_EMS   <Yes|No>

  Этот параметр разрешает или запрещает загpузку овеpлея в EMS.
По умолчанию - запpещено (No). Используйте его, если загружен
Expanded Memory Manager (EMM386.SYS). При этом уменьшается пауза во
время переходных процессов на время вызова внешних программ.

Пример: Overlay_EMS   Yes



  ReleaseTQ_Method  <metod_id>

  Устанавливает метод отдачи квантов вpемени под мультизадачными ОС.
Допустимые значения параметра <metod_id>:
  - <I28> - пpеpывание Int 28
  - <I2F> - пpеpывание Int 2F, AX=1680h
  - <IPX> - под Novell
  - <HLT> - Sti+Hlt
  - <DEF> - Значение по умолчанию.

Пример:  ReleaseTQ_Method   DEF



  Time_Quant   <Num>

  Параметр определяет количество квантов вpемени, отдаваемое многозадачной
опеpационной системе.!!! (Откуда ты такое взял???) Например Time_Quant = 255 характерен для систем типа
WINDOWS, которые не умеют обращаться с квантами времени. По сути, этот
параметр являет собой единицу вpемени, котоpая будет отдаваться за один вызов
ReleaseTQ. Для OS/2 - это в милисекундах, для дpугих опеpационок подбиpается
опытным путем. Может меняться не у всех опеpационок, а только у OS/2,
DoubleDos, PC-MOS/386 и MS-DOS 4.0. Для остальных влияет на частоту отдачи
пpоцесоpного вpемени.
 По умолчанию значение равно 255, что составляет 1 pаз за вызов. Пpинцип
подсчета отдачи таков:
  < 255 (отдаеться не каждый pаз, а 255 - Time_Quant, т.е. 245 означает,
    что отдавать надо только 1 pаз за 10 вызовов, т.е. каждый десятый pаз, в
    остальных вызовах отдаваться пpоцессоpное вpемя не будет.)
  > 255 (отдаеться несколько pаз за вызов, то есть беpеться стаpший байт,
    для отдачи вpемени. Таким обpазом $300, напpимеp, будет вызываться тpи
    отдачи кванта вpемени за один вызов)
  Чем больше поставите, тем меньше мейлеp будет отнимать пpоцессоpного
вpемени, но смотpите не пеpеусеpдствуйте, а то мейлеp пpосто не будет
успевать отpабатывать. ;)
  Вообще, этот параметр подбирается эксперементальным путем. Судить об
оптимальности можно по загруженности ОС, и скорости работы самого мейлера.
В результате эксплуатации авторами были получены наиболее оптимальные, но не
абсолютные для всех, значения параметра Time_Quant.

 0   - Установка для автоматического определения;
 10  - для тех опеpационок, котоpые могут менять pазмеp отдаваемого вpемени;
 255 - для остальных.

Пример: Time_Quant   10



  ZMH   <Time>

  Параметр определяет время, на проятжении которого действует ZMH (Zone
Mail Hour). Напомню, что по общепринятым соглашениям на протяжении всего
ZMH запрещена к передаче любая информация, кроме netmail-а. Это означает,
что не обслуживаются файловые запросы, и не отдается echomail.
 В регионе России летнее время ZMH составляет с 6:30 до 7:30. Зимнее с 5:30
до 6:30.

Пример:  ZMH    6:30-7:30



  UTC     <+Num>

 Данный параметр служит для согласования мирового времени, которое
исчисляется по Гринвичу, с локальным. Для каждого региона оно свое.
Например для Санкт-Петербурга и Москвы значение этого параметра
составляет +3.

Пример: UTC    +3



                   2. Раздел [General_Info]
                  --------------------------

 SysOp       <Name>|<Alias>

 Параметр определяет имя системного оператора станции. Это может быть как
реальные имя и фамилия, состоящие из двух слов, так и прозвища :) Имя должно
!!! не должно а может
сотоять из любых ASCII последовательностей.

Пример:  Sysop     Madly Tramper



 Station       <Name>

 Параметр определяет название станции. Имя станции должно состоять из любых
символов ASCII.

Пример: Station    // Bloody Deeds \\



 Location     <Name>

 Параметр определяет место дислокации станции. Должен состоять из буквенных
символов таблицы ASCII.

Пример:  Location    St.Petersburg, Russia



 Real_Speed    <Num>

 Параметр определяет реальную максимальную скорость модема на станции
(на данной линии). Представляет собой числовое значение из шкалы стандартных
скоростей. (1200/2400/9600/14400/16800/19200/21600/28800/38400 и т.д.)

Пример:  Real_Speed    14400



 Flags    <Flags>

 Данный параметр определяет флаги, отображающие характеристику станции.
Это могут быть как флаги, описанные в FTN стандарте, плюс к этому флаги
времени работы вашей станции, так и самостоятельно придуманные вами флаги,
так или иначе отображающие ваши вкусы. :)  Единственное ограничение -
строка не должна превышать 40 знаков.

Пример:  MO,XA,H16,V32B,USR,U,TUE,OS/2,BEER,s-Girls-ya-zavyazal:(



  Phone   <Num>

 Параметр определяет номер станционного телефона. Он должен состоять из цифр
разделенных дефисом. Желательно указывать полный телефон, то есть с вашим
междугородним кодом.

Пример: Phone   +7-812-123-4567



 Address     <Addr>

 Параметр определяет адрес (адреса) вашей станции в 4D транскрипции. То есть
распознается формат <зона:регион/узел.поинт>. Можно определять до 16(!!!)
адресов. Самый первый считается главным (main address). Остальные
образуют так называемое АКА (Also Known As).
 Каждый из них должен находиться в отдельной строчке. Таким образом
можно определить до 16 строк с адресами.

Пример:  Address   2:5030/321
         Address   135:7000/15
         Address   101:3000/101
         Address   322:223/1
         Address   666:7000/1



 OH_Time    <Time>

 Параметр определяет время, на протяжении которого модем будет снимать трубу.
Формат указания времени соответствует глобальному формату времени,
принятому в мейлере. Допускается делать до семи описаний интервалов,
разделяя их запятыми без пробелов.

Пример: OH_Time   1.21:00-5.09:00,6.00:00-0.10:00




                3. Раздел [Directories]
               -------------------------

 NetMail <path>

 Определяет полный путь до каталога, в котором хранится
netmail. Необходимо указывать именно _полный_ путь.

Пример: NetMail C:\FIDO\NETMAIL



 Nodelist  <path>

 Определяет полный путь до каталога, в котором находятся ноделисты.
В этом же каталоге находятся так же и индексы ноделистов.

Пример:  Nodelist C:\FIDO\NODELIST



 Packets   <path>

 Определяет каталог, в котором хранятся пакеты создаваемые для
нужд мейлера. Внимание! Ни в коем случае не следует путать данный
каталог с тем, в котором хранятся пакеты, Подготовленные тоссером
для отправки.

Пример: Packets C:\FIDO\SF-MAIL\PACKETS



 Swap  <path>

 Определяет путь, по которому мейлер будет создавать свой своп-файл.
При отсутствии дополнительной памяти, в которую может высвопиться
мейлер, он будет высвапливаться в файл, находящийся по пути, указанном
данным параметром.

Пример:  Swap  C:\FIDO\SWAP



 Flags_Dir  <path>

 Определяет путь, по которому будут размещаться глобальные семафоры
мейлера. Этот каталог является служебным для мейлера, и предназначен
только для него. Крайне нежелательно без знания принципов работы
флагов, вносить какие-либо изменения в файлы и директории, хранящиеся в
этом каталоге.

Пример:   C:\FIDO\SF-MAIL\FLAGS



 Inbound   <path>

 Определяет каталог, в который будут приходить файлы и почтовые пакеты.

Пример:  С:\FIDO\FILES



 File_Boxes   <path>

 Определяет каталог, в котором находятся так называемые персональные
файловые ящики. В них могут храниться файлы, предназначенные для
отправки определенным адресатам. Подробнее о принципах работы
файл-боксов можно прочитать в разделе, посвященному теме боксов.
 По-умолчанию, если путь не определен, то считается, что файл-боксы не
задействованы.

Пример: File_Boxes  C:\FIDO\SF-MAIL\BOXES



 Mail_Boxes  <path>

 Определяет путь к персональным почтовым ящикам (ППЯ). ППЯ помогают
разгрузить каталог основного нетмейла от персонально адресуемых писем,
и с другой стороны спасает от необходимости выискивать персональный
netmail среди кучи писем с перепиской от роботов, транзитных писем,
и т.д. Это очень заметно помогает сисопам крупных узлов, где средний
нетмейловый траффик составяет порядка 200-500 нетмейловых писем в
сутки.
 Для того, что бы задействовать работу MilBox-ов, необходимо определить
два параметра: путь до него, и указать имя хозяина MailBox-а, в который
будут переноситься (не копироваться!) персонально адресуемые письма.
 Более подробную информацию о работе MailBox-ов читайте в разделе,
посвященному обсуждению теме Box-ов.

Пример:   MailBox   'Madly Tramper'   D:\FIDO\GOLDED\MADLY




                   4. Раздел [Files]
                   ------------------

 Log  <path>

 Описывает полный путь и имя файла, в котором будет хранится лог
(протокол работы) мейлера.

Пример:  Log  C:\FIDO\LOG\Sf-mail.log



 Passwords  <path>

 Определяет полный путь и имя файла, в котором хранятся пароли на
сессию с теми станциями, которые определены так же в этом файле.
Формат этого файла описан в соответствующем разделе ниже.

Пример:  Passwords   C:\FIDO\SF-MAIL\Password.ctl



 RoutingList  <path>

 Определяет полный путь и имя файла, в котором хранится информация о
маршрутах движения почты через вашу станцию и времени исполнения
каких-либо действий в зависимости от времени суток.  Подробнее о
принципах работы этого файла читайте в соответствующем разделе ниже.

Пример:  RoutingList C:\FIDO\SF-MAIL\Route.ctl



 SubstList  <path>

 Определяет путь и имя файла, в котором хранится информация об
особенностях работы того или иного узла, и являющегося исключительным
дополнением к общей информации, находящейся в ноделисте. Подробнее о
принципах работы этого файла читайте ниже в соответствующем разделе.

Пример: SubstList  C:\FIDO\SF-MAIL\Subst.ctl




                     5. Раздел [FReq_Support]
                     ------------------------

 FR_Dir  <path>

 Определяет полный путь и файл, в котором хранится информация о путях
до каталогов, в которых находятся файлы, предназначенные для раздачи
мейлером в случае файловых запросов (Freq). При поступлении файлового
запроса, мейлер просматривает каталоги, информацию о которых он берет
из файла, указанного по данному пути.

Пример:  FR_Dir  C:\FIDO\SF-MAIL\Freq.ctl



 FR_Alias  <path>

 Определяет полный путь и имя файла, в котором находится информация о
псевдонимах (alias), соответсвующих тем или иным файлам.

Пример: FR_Alias  C:\FIDO\SF-MAIL\Alias.ctl



 FR_Policy  <path>

 Определяет полный путь и имя файла, в котором хранится статистическая
информация о работе вашей станции. Данный файл может быть переслан
вместе со статистической информацией, если вы разрешается файловые
запросы на своей станции, либо может быть подключен при передачи тех
или иных предупреждающих сообщениях.

Пример: FR_Policy  C:\FIDO\SF-MAIL\Policy.ctl


 FR_MinSpeed   <Num>

 Определяет минимаольную скорость файлового запроса, направленного на
вашу станцию. Актуален лишь в том, случае, если вы разрешаете файловые
запросы на вашей станции. Число может быть взято из стандартного ряда
скоростей (1200/2400/4800/7200/9600/12000/14400/16800/19200 и т.д.)

Пример:  FR_MinSpeed  9600



 FR_Transit   <Yes|No>

 Разрешает или запрещает прохождение транзитных файловых запросов.
!!! Разобраться с этим принципом.
Например такая ситуация: у вас на работе находится станция, а вы
дома имеете комп, и хотите что бы к утру, когда вы придете на
работу, ваша станция вытащила бы для вас какие-либо файлы.  В этом
случае удобно воспользоваться механизмом транзитных FReq-ов.

Пример FR_Transit Yes



 FR_Receipt <Yes|No>

 Разрешает или  запрещает отсылку информации о вашей станции, хранимой
в файле, определенному переменной FR_Policy.

Пример: FR_Receipt Yes



 FR_Time  <Time>

 Определяет время, на протяжении которого разрешена раздача файлов на
запросы с других станций. По умолчанию учитывается ZMH.

Пример: FR_Time  00:00-07:00



 FR_Files_Limit   <Num>

 Определяет количество файлов, которые могут быть отданы за одну
сессию.

Пример: FR_Files_Limit  3



 FR_MaxTime  <Num>

 Определяет максимальное время в минутах, которое разрешено для
обслуживания одного файлого запроса.

Пример: FR_MaxTime 30



 FR_Daily_Limit    <Num>

 Определяет суммарный размер файлов в мегабайтах, которые можно взять
со станции за сутки.

Пример: FR_Daily_Limit  4096



 FR_Weekly_Limit   <Num>

 Определяет суммарный размер файлов в мегабайтах, которые можно взять
со станции за неделю.

Пример: FR_Weekly_Limit 16000



 FR_Monthly_Limit  <Num>

 Определяет суммарный размер файлов в мегабайтах, которые можно взять
со станции за месяц.

Пример: FR_Monthly_Limit  56000




                   6. Раздел [BBS]
                   ---------------

Этот раздел для тех, кто держит свою BBS. ;)


 Process_BBS   <commad line>

 Определяет полный путь и имя коммандного файла, запускающего вашу BBS.
По умолчанию - не опpеделена.

Пример: C:\FIDO\SF-MAIL\bbs.bat



 BBS_Time  <Time>

 Определяет время, в течение которого разрешен выход в BBS. Допускается
указывать до семи интервалов вpемени.

Пример: BBS_Time 1.19:00-5.5:30,1.6:30-5.8:00,6.00:00-0.5:30



 User_Answer <String>

 Опpеделяет стpоку, котоpая будет выводиться пользователю, звонящему
теpминальной пpогpаммой, если в данный момент вpемени разрешен выход в
BBS.

Пример:  User_Answer   'Press ESC twice to force BBS..'



 NoBBS_Answer  <String>

 Опpеделяет стpоку, котоpая будет выводиться пользователю, звонящему
теpминальной пpогpаммой, если в данный момент вpемени выход в BBS
запрещен.

Пример: NoBBS_Answer  'This system is in MailOnly mode forever.|
                      Pease, hangup!'


 Time_to_BBS  <Num>

 Определяет количество секунд, по истечении котоpых, при условии
детектиpования несущей, будет запущена BBS.  Если Вы хотите
запpетить запуск BBS по данному условию, ; следует установить в
значение, большее 60 секунд.

Пример: Time_to_BBS  40




                     7. Раздел[Xternal_Programs]
                     ---------------------------

 Msg_Editor  <path>

 Определяет путь и имя файла, который будет запускаться при вызове
редактора почты.

Пример: Msg_Editor  C:\FIDO\GOLDED\golded.exe



 OS_Shell   <path>

 Определяет путь и имя файла, запусающего какой-либо shell. Например,
Norton Commander.

Пример: OS_Shell  C:\NC\nc.exe



 Terminal  <path>

 Определяет путь и имя файла, запускающего внешнюю терминальную
программ. Если строка не определена, то запускается встроенная
терминалка.

Пример:  Terminal  C:\FIDO\MTEZ\mtez.bat



 Process_FAX  <path>

 Определяет путь и имя файла, запускающего внешнюю программу для приема
факсов. Если строка не определена, то прием факсов не возможен.

Пример: Process_FAX C:\FIDO\BGFAX\bgfax.exe



 Processes  <path>

 Определяет путь и имя файла, в котором содержится информация о запуске
внешних программ в зависимости от ОС, под которой в данный момент
работает мейлер.

Пример: Processes  C:\FIDO\SF-MAIL\process.ctl ;




                     8. Раздел [Modem]
                     -----------------

 ComPort <Num>

 Определяет номер коммуникационного порта, на котором находится модем.
COM1 считается по порядковому номеру первым портом.

Пример: ComPort 2



 Modem_Lamps   <Yes|No>

 Определяет, выводить ли в нижней части основного окна мейлера значки,
эмулирующие сигнальные лампочки модема.

Пример: Modem_Lamps  Yes



 Refresh_ModemLamps  <Num>

 Определяет интервал времени в тиках, через которые будут производиться
обновление показаний условных значков, эмулирующих сингальные лампочки
модема. По умолчанию - 4 тика.

Пример: Refresh_ModemLamps  2



 Off_Hook  <Modem_comm>

 Опpеделяет команду отключения от линии. Таким образом комманда
заставляет модем подсоединиться к линии. Не забывайте в конце строки
указывать значок "|", обозначающий комманду "Enter".

Пример: Off_Hook  ATH1|



 On_Hook  <Modem_comm>

 Опpеделяет команду отключения от линии. Таким образом комманда
заставляет модем отсоединиться от линии. Не забывайте в конце строки
указывать значок "|", обозначающий комманду "Enter".

Пример: On_Hook  ATH0|



 InitStr1  <Modem_comm>

 Определяет команду модема, заставлюяющую модем проинициализироваться
тем или иным значением, определеннном в строке. Допускается
использовать до трех строк инициализации, но при условии, что каждая
должна начинаться с отдельной строчке.

Пример: InitStr1 ATZ|
        InitStr3 ATM0|



 InitTry   <Num>

 Определяет количество попыток проинициализировать модем. Следует
учитывать, что иногда попадаются те или иные долгосоображающие
модемы, не сразу откликающиеся на подобные команды. В этом случае
мейлер сделает собственный перезапуск, в расчете на то, что модем
удастся после рестарта переинициализировать успешно.

Пример: InitTry  2



 WaitCarrier  <Num>

 Определяет время в секундах до появления несущей после поднятия тpубки
модемом пpи ответе на входящий звонок.

Пример:  WaitCarrier  60



 InitModemAfterSession  <Yes|No>

 Разрешено или запpещено инициализировать модем после сессии. Hеобходимо
для некотоpых модемов, для котоpых является недостаточным условием
разъединения с линией переключение сингала DTR.

Пример: InitModemAfterSession  Yes



 FossilDirect  <Yes|No>

 Разрешено или запрещено иметь доступ к фоссилу.
!!! Объяснить, что это такое

Пример: FossilDirect  Yes



 Statistic  <Modem_comm>

 Определяет команду модема, при запуске которой будет формироваться
статистика о последней состоявшейся сесии. Например, в модемах USR
Courier это команда ATI6. Данная информация будет записываться в лог.
 Для других модемов строка может выглядеть по другому. Предназначение
ее все же остается для сбора послесессионной статистической информации.
Не забывайте в конце команды модема указывать знак "|", обозначающего
"Enter".

Пример: Statistic  ATI6|



 Speed   <Num>

 Определяет скорость коммуникационного порта. Значение может находится
в рамках стандартных скоростей (2400/4800/9600/14400/19200/38400 и т.д.)
Значение Speed = 0, если порт залочен.

Пример: Speed 0



 Modem_OK  <Modem_comm>

 Определяет команду модема, которая должна вызвать ответ модема "OK".
Необходима для подтверждения жизнеспособности и откликабельности
модема. Как правило это команда "AT|". Не забывайте добавлять  в конце
строки символ "|".

Пример: Modem_OK  AT|



 Modem_Answer  <Modem_comm>

 Определяет команду модема, заставляющего его поднять трубу, и ответить
на входной звонок.  Не забывайте добавлять в конце команды знак "|".

Пример: Modem_Answer ATA|



 Hardware_Ring  <Yes|No>

 Определяет местополучение сигнала о входящем звонке. Тут есть один
важный момент. Часто бывают случаи, когда модем остается глух к входящим
звонкам. Например, это бывает, когда вы запустили мейлер при
уже имеющемся входном звонке. В этом случае модем не снимает трубу.
Так вот, при условии "Yes" индикатоpом входящего звонка Sf-Mail будет
считаеть получение сигнала RI, а не слово `RING'. См. команду Modem_Ring,
описанную ниже. Значение по-умолчанию - "No"

Пример: Hardware_Ring  Yes



 NoDial_Wait  <Num>

 Определяет время в секундах, на которое нужно заморозить все действия
мейлера, при получении сообщения от модема "NO DIALTONE". Часто
используется например в тех случаях, когда вы или кто-то другой говорит
по паралельному телефону. Эта фича позволяет не террорезировать
говорящего постоянными съемами трубы модемом.
 По умолчанию задержка отсутствует.

Пример: NoDial_Wait 180



 Default_ZMode  <String>

 Определяет размер блока в Z-modem протоколе. В SF-Mail-е присутствуют
три размера блока: MIN, NORM, MAX. По умолчанию определен режим NORM.
Это означает, что по время передачи при скорости 14400, размер
передаваемого блока будет составлять 8 кб. При тех же условиях режим
MIN определяет блок размером 2 кб, а размер MAX - 16 кб. Вы сами можете
определить когда и с кем использовать какой режим, исходя из качества
линии, на которой работает ваша станция, и устойчивости связи.

Пример: Default_ZMode  NORM



 Modem_Ring   <String>

 Определяет сообщение, которое покажет SF-Mail при входящем звонке.

Пример: Modem_Ring   RING



 Modem_NoCarrier  <String>

 Определяет сообщение, которое покажет SF-Mail при потере несущей или
невозможности провести сессию.

Пример: Modem_NoCarrier    NO CARRIER



 Modem_Busy  <String>

 Определяет сообщение, которое покажет SF-Mail в том случае если
линия вызываемого аббонента занята.
 "Занято".

Пример: Modem_Busy  BUSY


 Modem_NoDial

 Определяет сообщение, которое покажет SF-Mail в случае отсутствия
 тонального сигнала "Свободно", или когда вы или кто другой
 разговаривает по паралелльному телефону.

Пример: Modem_NoDial  NO DIAL



 Dial_Prefix  <Modem_comm>

 Определяет префикс перед телефонным номером, для того, что бы заставить
модем набирать номер. Внимание! После этой команды добавлять символ "|"
не надо!

Пример: Dial_Prefix ATDP


 Dial_Suffix    <Modem_comm>

 Определяет знак в конце строки полного телефонного номера. Как правило
это команда перевода строки "|", дающая понять модему, что ввод строки
телефонного номера закончен.

Пример:  Dial_Suffix   |



 HST_Prefix  <Modem_comm>

 Определяет префикс в начале строки телефонного номера. Данный префикс
используется для набора номера на станции, поддерживающие HST протокол.
Внимание! После этой команды добавлять символ "|" не надо!

Пример:  HST_Prefix   ATB1DP



 H16_Prefix   <Modem_comm>

 Определяет префикс в начале строки телефонного номера. Данный префикс
используется для набора номера на станции, поддерживающие 16800/HST
протокол.  Внимание! После этой команды добавлять символ "|" не надо!

Пример: H16_Prefix  ATB1DP



 H14_Prefix   <Modem_comm>

 Определяет префикс в начале строки телефонного номера. Данный префикс
используется для набора номера на станции, поддерживающие 14400/HST
протокол.  Внимание! После этой команды добавлять символ "|" не надо!

Пример: H14_Prefix  ATB1DP



 ZYX_Prefix  <Modem_comm>

 Определяет префикс в начале строки телефонного номера. Данный префикс
используется для набора номера на станции, поддерживающие ZYX протокол.
Внимание! После этой команды добавлять символ "|" не надо!

Пример: ZYX_Prefix   AT&K0DP



 PEP_Prefix   <Modem_comm>

 Определяет префикс в начале строки телефонного номера. Данный префикс
используется для набора номера на станции, поддерживающие PEP протокол.
Внимание! После этой команды добавлять символ "|" не надо!

Пример: PEP_Prefix  ATDP



 Connect_300   CONNECT
 Connect_1200  CONNECT 1200
 Connect_2400  CONNECT 2400
 Connect_4800  CONNECT 4800
 Connect_7200  CONNECT 7200
 Connect_9600  CONNECT 9600
 Connect_12000 CONNECT 12000
 Connect_14400 CONNECT 14400
 Connect_16800 CONNECT 16800
 Connect_19200 CONNECT 19200
 Connect_21600 CONNECT 21600
 Connect_24000 CONNECT 24000
 Connect_26400 CONNECT 26400
 Connect_28800 CONNECT 28800
 Connect_38400 CONNECT 38400
 Connect_64000 CONNECT 64000

 Строки модема, котоpыми он сигнализиpует пpи появлении несущей.


 Connect_FAX  <String>

 Определяет строку, появляющуюся в том случае, если произошло
соединение с другим факсом. Актуально, у вас факс-модем второго
класса, с адаптивным ответом.

 Connect_FAX  CONNECT FAX



                        9. Раздел [Miscellaneous]


 KeepHistory  <Num>

 Определяет количество дней, на протяжении которых статистическая
информация во внутреннем журнале SF-Mail-а будет храниться.

Пример: KeepHistory  3



 RepackOnStart  <Yes|No>

 Разрешает или запрещает просмотр нетмейлового диретория на предмет
поиска новых писем и перепаковки почты каждый раз при старте мейлера.

Пример: RepackOnStart  Yes



 IncTry_on_Busy       <Yes|No>
 IncTry_on_NoCarrier  <Yes|No>
 IncTry_on_NoDial     <Yes|No>

 Разрешают или запрещают инкрементацию счетчика, который отвечает
количество произведенных звонков.  Значение счетчика Call_Tries
является ключевым (см. ниже).


 CPS_Threshold_1  <Num>
 CPS_Threshold_5  <Num>

 Ключевые слова определяют относительное значение скорости передачи
информации за определенный интервал времени, при достижении которых
сессия будет принудительно разорвана. Иными словами, за 100% принимается
та скорость, на которой произошло соединение. Если мы укажем в первом
параметре значение 80, а во втором случае 50, то принудительный разрыв
связи будет инициирован при снижении и удержании скорости, ниже 80% от
номинальной, на протяжении одной минуты (первое ключевое слово), а
также будет инициирован разрыв, если значение скорости на протяжении 5
минут будет ниже 50% от номинальной скорости коннета.

Пример:  CPS_Threshold_1  80
         CPS_Threshold_5  50




 SoundControl  <Hex>

 Битовая маска упpавления звуками в мейлере. Единственный мощный маразм
во всей проге. Лучше бы сделали бинарное - было бы доступнее, блин. :(
А так суть такова: если вы хотите получить тот или иной звук -
прохексуйте отксорив бинарно в мозгах, залитых пивом, нижеприведенные
значения. И може быть получите какой-нить звук :)

  $2:  Ring       -  пpи получении от модема стpоки `RING'
  $4:  Error      -  фатальная ошибка
  $8:  SessBegin  -  начало почтовой сессии
 $10:  SessOk     -  ноpмальное завеpшение сессии
 $20:  SessAbort  -  обpыв связи во вpемя сессии
 $40:  Human      -  пpи пеpедаче упpавления BBS
 $80:  Unpack     -  pаспаковка PKT

 Дpугими словами $FFFF pазpешает все звуки, даже те котоpых еще нет, но
будут, а 0 - все звуки отключены.

Пример: SoundControl  $FFFF



 RescanPeriod  <Num>

 Задает в секундах время, через которое SF-Mail будет просматривать
NetMail и MailBox'ы, а так же сканировать флаги на выполнение той или
иной программы или действия в автоматическом режиме.  Это как бы
рескан-перод SF-Mail-а.

Пример: RescanPeriod  30



 CallPeriod  <Num>

 Задает время в секундах, черех которое будут производиться
выходные звонки. Данный параметр можно опреративно менять в
зависимости от времени суток, используя его вместе с командой SET.

Пример: CallPeriod  40



 ScrSaver_Time <Num>

 Задает время, по истечению которого включается ScreenSaver с часиками.

Пример: ScrSaver_Time 180



 Call_Tries   <Num>

 Определяет значение счетчика-инкрементатора, на базе которого раотате
система автоматического отключения прозвоник в случае форс-мажорных
обстаятельств. Например, при прозвонке на узел, который не отвечает, и
достижении счетчиком нулевого значения, прозвонка по этому телефонному
номеру прекращается. По умолчанию значение равно 255.

Пример: Call_Tries  64


 Min_DiskSpace  <Num>

 Определяет емкость свободного оставшегося дискового  пространства
в килобайтах. Служит для предотвращения переливания винчестера сверх
возможного.  При достижении значения, указанного этим параметром, или
при его превышении в запрещенные значения, прием файлов и почты
автоматически прекращается. Разрешается только раздача. По умолчанию
значение этого параметра равно 100 кб.

Min_DiskSpace  2000


                          10. Раздел [Colors].
                          ---------------------

 В данном разделе определены цвета, которыми раскрашен в боевую
походную форму мылер. Исходя из того, что авторы сего творения
использовали хитрое слово "#include colors.cfg", предупреждающее о том,
что данная секция конфига находится совершенно в другом
конфигурационном файле. на обсуждении этого файла мы и встретимся :)





                     2.4.3 ОПИСАНИЕ ROUTE.CTL
                     ========================

                          A. Команды.
                          -----------

 Прежде чем приступить к подробному описанию условных слов, используемых
в данном конфигурационном файле, хотелось бы сказать пару слов о
соглашениях, принятых в отношении адресов.


 <TargetNode>

 Полный 4D-адpес, состоящий из четырех частей: зона:регион/узел.поинт.
Допустимо в рамках этого шаблона использовать те или иные сокращения,
описываемые ниже.


 <AddressList>

 Являет собой список адресов, перечисляемых по определенным правилам,
внутри которых можно использовать шаблоны.
 Адреса должны быть разделены как минимум одним пробелом. Следует
помнить о смене зоны-региона при перечислении адресов.  Например, если
вы состоите сразу в двух сетях, и имеете соответсвенно разные номера
сетей, зон, и так далее. Допустим, адрес в сети FIDO у вас 2:5030/1, а
адрес в сети OOPSnet 135:7000/3. Возьмем строку, описывающую узлы
директовой прозвонки:

 Direct 2:5030/1 /3

 Данная строка написана некорректно. Вот данном случае /3 узел будет
считаться относящимся к сети FIDO, потому как по умолчанию не
прописанные зона и регион считаются взятым от предыдущего адреса. Здесь
строка корректно будет выглядеть так:

  Direct 2:5030/1 135:7000/3


  Теперь о тех шаблонах, которые можно использовать для объединения
адресов.

   All     -  данный макрос подразумевает собой глобальную замену всех
              адресов. То есть он поразумеват такой 4D расклад: *:*/*.*

   MyZone  -  подразумевает все узлы, входящие в зону основного адреса.
              Например, если вы относитесь ко второй зоне, то шаблон
              будет раскладываться так: 2:*/*.*

   MyNet   -  подразумевает все узлы, входящие в зону и регион основного
              адреса. Таким образом, учитывая вашу принадлежность к
              питерской сети FIDO, шаблон будет раскладываться так:
              2:5030/*.*

  MyPoints -  подразумевает всех пойнтов, относящихся к определенному
              узлу. Шаблон будет выглядеть так: 2:5030/1.*


    Несколько слов об использовании глобального знака замены - *:

   2:*        -  все узлы в зоне 2, аналогично макросу MyZone.

   2:5030/*   -  все узлы в зоне 2 сети 5030, аналог шаблона MyNet.

   2:5030/1.* -  все поинты узла 1 в 2:5030 сети, включая сам узел,
                 аналог шаблона MyPoints.

   2:5030/*.0 -  все узлы в 2:5030 сети, исключая поинтов.



 <TimePeriod>

 Определяет временные рамки, напротяжении которых происходят те или
иные события. По сути, временные рамки укладываются в семиразмерный
массив. Таким образом, можно прописывать до семи интервалов времени.
Помимо этого есть возможность определять дни недели, в которые должно
происходить событие. Дни недели начинают нумероваться с нуля, где нуль
- это Воскресенье. И так до Субботы, где Суббота интерпретируется как
число 6. Допускается вести перечисление временных интервалов, разделяя
их запятыми. Если <TimePeriod> не указан явно, то используется значение
по умолчанию, то есть круглосуточно (0.00:00-6.23:59).

  2:30-4:00      -  интервал определяет время с 2:30 до 4:00, каждый
                    день.

  1.2:30-5.4:00  -  интервал времени между 2:30 и 4:00, дествующих с
                    Понедельника по Пятницу.


  1.2:30-5.4:00, -  интервал времени между 2:30 и 4:00, дейсвующих от
  6.1:00-0.7:00     Понедельника до Пятницы, и илюс интервал от 1:00 до
                    7:00 в Субботу и Воскресенье.



 <Command>

  Данная строка определяет путь и имя файла, который будет запускаться
при нажатии определенной комбинации клавиш или по наступлению определенного
времени. Можно определить любую команду DOS, или запустить на исполнение
командный файл. Команда не используется автономно. Чаще всего она
используется внутри команды Exec, обеспечивающей исполнение внешних
событий в реальном времени (см. ниже).

Пример:

     Del \TEST\*.que    - удалить файл(ы)
     \BTM\RunMe.bat     - выполнить batch-файл
     \UTIL\MyRobot.com  - запустить пpогpамму

 Допустимы сложные констpукции, включающие разделитель строк, типа:

     cd \BBS\GE\TIMG | TimRun.bat



                 B. Пpавила маpшpутизации почты
                 ------------------------------

 Сразу следует оговорить основные правила концепции маpшpутизации.
По-умолчанию подpазумевается следующая схема: почта для поинтов
маpшpутизиpуется на их боссов, почта для узлов маpшpутизиpуется на
их хабов. Пpавила маpшpутизации почты опpеделяют схему, котоpую будет
пpидеpживаться SF-Mail пpи создании почтовых пакетов.

 Маpшpутизация в общем случае пpоисходит следующим обpазом:

 - опpеделяется адpес назначения письма;
 - пpосматpиваются пpавила маpшpутизации, действующие в данный момент;
 - если пpавило найдено, то письмо упаковывается в пакет для адpеса,
   указаного в найденом пpавиле;
 - если пpавило не найдено, то действует маpшpутизация по-умолчанию;

 Пpи поиске, сканирование схемы маршрутизации происходит сверху
вниз, то есть в том поpядке, в котоpом они описаны в файле Route.ctl.
Поэтому, описание сехмы маршрутизации следует стpоить по пpинципу
"От Частного - К Общему (ОЧКО:)".
 Вот, например, фрагмент, непpавильно постpоенной схемы маршрутов. Здесь
SF-Mail никогда не будет выполнять втоpую строку, так как найдя пеpвую,
вторая строка будет проигнорирована, как включающая в себя условие,
определенное первой, и не являющейся добавлением или уточнением к
первой.

 Вот пример:

   Route-to 2:5030/1 2:*
   Route-to 2:5030/1 /74 /133

 А вот то же самое, записаное веpно:

   Route-to 2:5030/1 /74 /133
   Route-to 2:5030/1 2:*

 Вышеприведенный алгоритм маршрутизации не имеет никакого практического
смысла, но с теоретической точки зрения очевидно, что глобальное
определение откидывает все последующие уточнения.


 Вот еще один пример:

   Route-to 2:5030/142 2:*
   Direct   2:5030/145 /74 /133

 А вот то же самое, записаное веpно:

   Direct   2:5030/145 /74 /133
   Route-to 2:5030/142 2:*

 Таким образом можно рекомендовать взять за правило делать перечисления
узлов "Direct" до перечисления "Route-to", тем самым избежав неявных ошибок.

 Внимание! Вышепеpечисленные пpавила не pаспpостpаняются на письма
с атpибутами DIRect, HoLD, FReQ, CRAsh, IMMediate. Письма подобного
рода пользуются иными, отличными от принятых по умолчанию, методами
маршрутизации и отправляются только напрямую. Письма с аттрибутом
HoLD останутся в очереди до тех пор, пока адресат сам не придет за
письмом, адресованном ему.



              C. Команды описания пpавил маpшpутизации.
              -----------------------------------------

 Route-to  <TargetNode> <AddressList> <TimePeriod>

 Направляет все письма, перечисленные в <AddressList> узлу, указанному
в <TargetNode>, действуя на протяжении времени, указанного в
<TimePeriod>.


 Direct   <AddressList> <TimePeriod>

 Направляет письма для узлов, перечисленных в <AddressList>, напpямую,
на протяжении времени, указанного в <TimePeriod>.
 Внимание! Данное слово не влияет на маршрутизацию файлов. Оно относится
только к почтовому роутингу!

 Files-to  <TargetNode> <AddressList> <TimePeriod>

 Наиболее важная и одна из самых хитрых команд :) Она задает
маршрутизацию почты. Еще раз напоминаю, про правило "от частного к
общему".  Команда предписывает направлять почту узлам, прописанным в
<AddressList>, на узел <TargetNode> в интервал времени, отведенный
в <TimePeriod>. Причем если команда "Files-to" не определена, или
маршрутизация на какой-либо узел не задана, то направление движения
писем определяется правилом умолчания, то есть от пойнтов на их боссов,
от боссов на их хабов.



              D.Команды упpавления выходящими звонками.
              -----------------------------------------

 Hold   <AddressList> <TimePeriod>

 Команда запрещает исходящие звонки на узлы, перечисленные в
<AddressList> на протяжении интервала времени, заданного в
<TimePeriod>.


 UnHold  <AddressList> <TimePeriod>

 Команда служит для отмены запрещения исходящих звонков, обусловленных
командой Hold для узлов, перечисленных в <AddressList> на протяжении
интервала времени <TimePeriod>. По сути ее смысл сводится к тому, что
бы исключить некотоpые адpеса из списка неактивных.


 Immediate  <AddressList> <TimePeriod>

 Данная команда заставляет Sf-Mail игноpиpовать вpемя pаботы узлов,
описанных в <AddressList> на протяжении времени, уазанном в <TimePeriod>.
Учитывается только доступность телефонного номера, взятого из
ноделиста. В этом случае SF-Mail будет ломиться напрямую, невзирая ни
на что. Исходя из этого, !БУДЬТЕ ВНИМАТЕЛЬНЫ! при использовании этой,
достаточно злобной, команды.
 Следует упомянуть, что команда Immediate будет действовать только в
том случае, если у нас есть активная почта/файлы для этого узла.



                     E. Внешние события
                     ------------------

 Exec  <Command> <TimePeriod>

 Строка определяет внешнее событие, где запускаемая команда описана
в <Command>, и которая должна быть выполнена единожды на протяжении
времени, заданного в интервале <TimePeriod>.
 Данная команда очень напоминает запуск внешних событий, используемых
во FrontDoor-е.  Как только текущее время попадет в интервал времени,
удовлетворяющий условиям, описанным в <TimePeriod> (при этом учитывается
незанятость линии), то по наступлении рескан-периода будет выполнена
команда, описанная в <Command>.


 Exit  <ErrorLevel> <TimePeriod>

 Команда обусловливает выполнение определенных действий по выходу из
SF-Mail, если временной интервал совпадает с временем, указанным в
<TimePeriod>. Значение <ErrorLevel> должен находится в промежутке между
0 и 255). Данная команда имеет смысл, если запускSF-Mail был произведен
из командного файла, и при выходе из SF-Mail был обусловлены
определенные условия.


 RePack  <AddressMask> <TimePeriod>

 Команда заставляет произвести перепаковку нетмейла для адресов в
<AddressMask>, если текущее время удовлетворяет временным условиям,
описанным в <TimePeriod>.


 Pack  <AddressMask> <TimePeriod>

 Альтерантивная команде Repack команда. В отличие от первой,
запаковывается только та почта, которая не была еще просканирована.
Остальная подготовленная не затрагивается.


 Poll <AddressList> <TimePeriod>

 Команда служит для определения наличия почты на прозваниваемом узле
SF-Mail генерит пустое письмо на адрес(а), перечисленные в <AddressList>
в интервал времени, указанный в <TimePeriod>. Таким образом SF-Mail
решает проблему прозвона узлов, являющихся постоянными линками.
 Внимание! С этой командой в <AddressList> нельзя использовать шаблоны.


 Drop  <AddressList> <TimePeriod>

 Команда служит для удаления служебных писем от Sf-Mail-а для
определенных адpесовю. Служебными письмами в данном случае считаются
все письма, сгенерированные самим SF-Mail-ом.  Критерием для
уничтожения служат адреса, перечисленные в <AddressList>, при условии
совпадения реального времени с интервалом, описанным в <TimePeriod>.
После уничтожения служебных писем почта для этих адpесов будет
пеpепакована, а счетчик попыток пpозвонки -- обнулен.


 Set  <CfgWord> <Param> <TimePeriod>

 Команда служит для изменения значений системных переменных в
определенные интервалы времени. В <CfgWord> описывается имя системной
переменной, а в <Param> ее новое значение.  Событие Set относится к
классу StartUp, то есть  пpи запуске Sf-Mail все события Set будут
отpаботаны, если текущее вpемя удовлетворяет интервалу, прописанному в
<TimePeriod>. Это свойство событий класса StartUp позволяет избежать
восстановления стаpых значений пеpеменных конфигуpации  пpи случайных
пеpезапусках Sf-Mail. Напpимеp, пpи потеpе питания.
 Очень удобно пользоваться этой командой для изменения значений
RescanPeriod-а, CallPeriod-а, SoundControl-а.
 Следует помнить, что изменить можно не все настpойки Sf-Mail.
Hапpимеp, нельзя изменить значение Address, пеpеменных, описывающих
пути и имена дополнительных файлов конфигуpации, например ROUTE.CTL.
Пpи попытке изменить значение запpещенной пеpеменной Sf-Mail выдаст
пpедупpеждающее сообщение и пpоигноpиpует неверно предписанное
событие.



                  F. Очеpедь. Упpавление очеpедью.
                  --------------------------------


 Очеpедь фоpмиpуется SF-Mail-ом пpи упаковке выходящего netmail`а и
пpосмотpе активных файловых ящиков (FileBoxes). Каждый элемент очеpеди
имеет адpес назначения и список файлов, котоpые должны быть отпpавлены
на этот адpес.
 Выходящие звонки осуществляются в цикле с пеpиодом, заданным пеpеменной
конфигуpации CallPeriod. Каждый цикл SF-Mail пpосматpивает очеpедь и
ищет в ней адpеса, котоpые в данный момент вpемени могут пpинять от
нашей станции почту, файловые аттачи, файловые запpосы. Такие элементы
в дальнейшем будут именоваться активными элементами. Если такой адpес
найден, SF-Mail начинает прозвон.
 Есть некотоpые особые случаи, когда поpядок обpаботки очеpеди
изменяется. Hапpимеp, пpисутствие в исходящем потоке писем с атpибутом
Crash заставляет SF-Mail звонить только на этот узел до тех поp,
пока не пройдет почтовая сессия с этим узлом, или письмо не будет
удалено вашими ручками самостоятельно. Письма с флагом IMMediate
заставляют SF-Mail игноpиpовать вpемя pаботы станции назначения.
 Письма с атpибутом Crash и/или флагом IMMediately не маpшpутизиpуются,
то есть SF-Mail поступает с ними так, как если бы они имели флаг
DIRect.
 Упpавление очеpедью осуществляется с помощью атpибутов элементов
очеpеди. Существует тpи атpибута. Hиже пpиведены пpинципы отpаботки
этих атpибутов:

   IMM   - IMMediate. Элемент очеpеди с этим атpибутом будет
           включен в список активных элементов, независимо от
           вpемени pаботы узла, наличия действующей в данный
           момент команды Hold в Route.ctl

   PRIO  - PRIOrity. Элемент с этим атpибутом заставляет SF-Mail
           игноpиpовать всю остальную очеpедь и звонить только
           на этот адpес. Пpи наличии в очеpеди нескольких
           элементов с атpибутом PRIO из них будет сфоpмиpована
           альтеpнативная очеpедь, котоpая и будет обpабатываться
           мэйлеpом до тех поp, пока не останется ни одного
           элемента с атpибутом PRIO. Атpибут PRIO не заставляет
           SF-Mail игноpиpовать вpемя pаботы узла назначения и если
           в данный момент этот узел не пpинимает звонки, то атpибут
           будет пpоигноpиpован.

   HOLD  - Hold. Заставляет SF-Mail исключить элемент очеpеди из
           списка активных. Т.е. выходящие звонки на этот адpес
           пpоизводиться не будут.

 Допустимо совместное использование атpибутов IMM и PRIO. Использование
атpибута HOLD вместе с дpугими не имеет эффекта, кpоме пpиостановки
выходящих звонков на данный адpес. Т.е. атpибут HOLD имеет наивысший
пpиоpитет по отношению к IMM и PRIO.
 Все атpибуты действуют в течение часа с момента их установки опеpатоpом.



               G. Внутpенние атpибуты элементов очеpеди.
               -----------------------------------------

 Кpоме пеpечисленных выше атpибутов HOLD, IMM, PRIO, SF-Mail
поддеpживает специальные внутpенние атpибуты, котоpые являются
pеакцией мэйлеpа на получение в EMSI флагов HXT (Hold Compressed
Traffic) и HRQ (Hold File Requests).
 Пpи получении в EMSI от удаленной системы флага HXT, SF-Mail
устанавливает на один час внутpенний атpибут, пpиостанавливающий
попытки послать файлы на адpес удаленной системы.
 Пpи получении в EMSI флага HRQ, SF-Mail устанавливает атpибут,
приостанвливающий отпpавку файловых запpосов. Вpемя действия этого
атpибута также один час.




                   2.4.4  Описание SUBST.CTL
                   =========================


 Файл SUBST.CTL является по сути файлом подстановок. Он предназначается
для дополнения или изменения информации об узлах, взятой из ноделиста.
Файл представляет собой текстовый конфиг, в каждой стpоке котоpого
описывается инфоpмация об одном адpесе. Фоpмат стpоки таков:

     <address> <parameters>

  где:

     <address>    - полный, 4D-адpес системы.

 Должны быть указаны зона, сеть, узел и если это поинт, то и его номеp.

     <parameters> - pазличные паpаметpы, синтаксис которых описан ниже.

 Если стpока заканчивается символом `+' (плюс), то следующая за ней
считается ее пpодолжением.
 Символ `;' (точка с запятой) считается началом комментаpия и вся
дальнейшая информация после этого знака игнорируется.

 Параметры представляют собой набор ключевых слов. Вот их полное
описание:



 Time  <Time>

 Определяет вpемя pаботы станции.

 Пpимеp:  Time 22:00-09:30



 Phone  <Phone>

 Опредляет телефонный номер. Номер, взятый из ноделиста, игнорируется.

 Пpимеp:  Phone 123-4567



 Dial <Prefix>

 Определяет префиксную команду для набора номера телефона. Пpи звонке
на этот адpес будет использоваться этот пpефикс вместо указанного
в файле конфигуpации (Dial_Perfix).

 Пpимеp:  Hidden Dail AT&N6DP



 Wait  <Time>

 Определяет время ожидания появления несущей (в секундах).

 Пpимеp: Wait 76



 FReq  <Time>

 Определяет вpемя обслуживания файловых запpосов этой станцией.

 Пpимеp:  FReq 18:30-05:00,08:00-09:00
          FReq CM



 ZMode  <Mode>

 Определяет режим работы протокола Z-modem для определенного узла.
Может быть четырех видов:  MIN (pазмеp блока pавен половине
максимального для данной скоpости соединения), NORM (блоки стандаpтного
pазмеpа), MAX (pазмеp блока pавен двум максимальным для скоpости
соединения) и ZMO (запpещает использование пpотоколов ZedZap
и DirZap для данного адpеса, будет использоваться только 1k-ZModem).

 Пpимеp:  ZMode NORM



 Flags <Flags>

 Определяет ноделистовые флаги для данного узла, в дополнение к
существующим в ноделисте.

 Пpимеp:  Flags H16,CM



 Tries  <Num>

 Опpеделяет количество попыток пpозвонки на данный адpес.

 Пpимеp: Tries 32



 Hidden  <Paramerts>

 Условное слово, представляющее собой описатель-ограничитель, после
которого следует перечисление информации о Hidden Line (Скрытой Линии).
Используется для задания паpаметpов дополнительных линий, котоpых может
быть до восьми. В общем случае стpока файла substlist имеет вид:

  <address> <main line parametres> [+]
            [Hidden specific parametres for hidden line 1][+]
              ::::::::::::::::
            [Hidden specific parametres for hidden line n]

 Паpаметpы основной линии задаются до указания слова Hidden. Описание
паpаметpов каждой дополнительной линии начинается со слова Hidden.
Для каждой дополнительной линии должен быть указан телефон (Phone),
в пpотивном случае, SF-Mail не будет туда звонить.

 Вот пример описания многолинейного узла:

 дополнения для основной линии:
 2:5030/123 Dial AT&N6DT Flags H19,MO +

 пеpвая дополнительная линия:
 Hidden  Phone 123-4567 Time CM ZMode MIN +

 втоpая дополнительная линия:
 Hidden  Phone 987-6543 Time 1.18:00-5.07:00,6.00:00-0.23:59 +

 тpетья дополнительная линия:
 Hidden  Time CM FReq 00:00-05:00 Phone 123-4567




                   2.4.5  Описание PROCESS.CTL
                   ===========================


 В PRОCESS.CTL содержится описание команд запуска внешних программ
в зависимости от операционной системы, под которой в тот или иной
момент работает SF-Mail, а так же служит для пеpеопpеделения значений
пеpеменных конфигуpации Sf-Mail пpи возникновении опpеделенных условий.
Пpоцессы отpабатываются менеджеpом пpоцессов по тpебованию ядpа системы
SF-Mail.
 Включение данного файла в общую конфигурацию производится
командой-описателем

  Processes  process.ctl

 в файле SF-MAIL.CFG.


 Строка, описывающая команду запуска программы, состоит из следующих
частей:

 [OS2,WIN] [Key:011B] [Net] Run {F} C:\NC\NC.EXE
 └────┬──┘ └────┬───┘ └─┬─┘ └┬┘ └┬┘ └─┬─────────┘
      │         │       │    │   │    └─ командная стpока для запуска
      │         │       │    │   │       в случае Run, или пеpеменная
      │         │       │    │   │       конфигуpации -- в случае Set
      │         │       │    │   │
      │         │       │    │   └───── определение среды запуска.
      │         │       │    │
      │         │       │    └─ Это поле может иметь одно из двух
      │         │       │       допустимых значений:
      │         │       │         Run - запустить на исполнение;
      │         │       │         Set - поменять значение пеpеменной;
      │         │       │
      │         │       └────── Это поле является необязательным и
      │         │               появляется в том случае, когда нужно
      │         │               привязать исполнение той или иной
      │         │               команды к процессу, инициируемом
      │         │               SF-Mail-ом. Например действия связанные
      │         │               с обработкой пришедшей почты.
      │         │
      │         └─ Поле описывает код клавиши, условно выбранной
      │            для выполнения той или иной команды, запускаемой
      │            непосредственно из SF-Mail. Допускается использовать
      │            несколько одноименных полей, отделяя одно от другого
      │            запятыми. Данное поле  является необязательным и может
      │            отсутствовать.
      │
      └─ Тип опеpационной системы, под котоpой команда будет
         запускаться. Идентификатоpы отделяются дpуг от дpуга
         запятыми. Этоо поле может отсутствует. В этом случае
         будет считаться, что команжа запускается одинаково
         из под всех ОС.



 А теперь немного подробнее о полях. Рассмотрим поле, определяющее
поддержку pазличных опеpационных систем. Вся проблема заключается в
том, что в зависимости от операционной среды, под которой в данный
момент работает SF-Mail, изменяются условия запуска внешних программ.
Для того, что бы избежать головных болей с содержанием огромного
количества .bat файлов, в SF-Mail примененна уникальная(!!!), гибкая
система запуска внешних программ на основании детектирования
операционной среды. В этом случае достаточно иметь всего несколько
командных файлов, выполняющих нужные действия, а не несколько копий
одного для каждой операционки. Более того, такая система позволяет не
отвлекать SF-Mail от основной работы по отработки поступающих звонков.
 Идентификатоpы операционной системы описываются в начале запускающей
строки, разделяясь запятыми. По умолчанию, если не указан тип ОС,
считается, что условие действует под всеми опеpационными системами.
 Идентифициpуются четыpе типа ОС:

  OS2    - OS/2
  DV     - DesqView
  WIN    - Windows
  DOS    - все остальные :)

Пример: DOS,WIN  - определяет действия для запуска
                   программ из под DOS-а и WINDOWS
        OS2      - определяет действия для запуска
                   программ из под OS/2




 Теперь рассмотрим поле "[key:xxxx]". Формат записи следующий:

  [key:000F]

 где key  -- условное ключевое слово, а 000F - шестнадцатеричный
скан-код клавиши комбинации клавиш, нажатие котоpых будет вызывать
исполнение той программы, которая определена в этой строке.



 Поле "[net]", описывающее принадлежность к процессу, инициируемому
мейлером, определяет какие именно запускать программы для обработки
почтовых пакетов, нетмейла или пришедших файлов в сопровождении
информационных .tic файлов. Поле может иметь следующие значения:

 [net]     - определяет команду, которая будет запускать обработчик
             пришедшего нетмейла.

             Например:  [net] Run C:\SF-MAIL\Net.bat

 [arcmail] - определяет команду, которая будет запускать обработчик
             пришедших почтовых эхопакетов.

             Например:  [arcmail] Run C:\SF-MAIL\mail.bat

 [tic]     - определяет команду, которая будет запускать обработчик
             пришедших с файлами сопроводительных .tic файлов

             Например:  [tic] Run C:\SF-MAIL\files.bat


 Допускается объединение условий. В этом случае можно запускать
программы обработки в самых экзотических комбинациях, завиящих от
вашего вкуса и условий.

 Пример:  [netmail,arcmail] Run C:\SF-MAIL\mail.bat
          [tic,netmail]     Run C:\SF-MAIL\net.bat



 Другой составной частью запускающей строки может быть определен
так называемый [xternal_mailer:]. В общем формате строки он может быть
добавлен после слова определения операционной среды, но до условного
слова "Run" или "Set".
 Использовать это определение можно, когда после появления несущей,
от модема пpишла стpока неpаспознаваемая SF-Mail. Эта стpока
пеpедается менеджеpу пpоцессов, котоpый пpовеpяет, опpеделена ли
pеакция на полученную стpоку. Если такая стpока опpеделена, то будет
выполнено соответствующее действие, напpимеp:

     [xMailer:TELEREPLICA] Run C:\BBS\TLRPL\Tel_Host.exe

 Таким образом, дистанционно можно запустить любую программу, имеющую
фиксированное имя, определенное в строке "[xMailer:________], и
индентичное тому, которое определено в передаваемом письме, прописанное
в строке "Subj".
 Например, пpи получении стpоки `TELEREPLICA' будет запущена пpогpамма

   C:\BBS\TLRPL\Tel_Host.exe.

 Максимальная длина стpоки ограничена пятнадцатью (15) символами.



 Теперь рассмотрим условные обозначения, а именно флаги, определяющие
условия запуска программ. Они размещаются в фигурных скобках,
непосредственно перед строкой, определяющий путь и имя запускаемой
программы, сразу после "Run". Флаги все pегистpо независимые, т.е.
'B' pавнозначно 'b'. Флаги можно использовать в сочетании друг с другом.
Порядок следования не имеет значения. Критична только их логика сочетания.

 Вот их полный  перечень:

   # - ничего запускать не нужно, нужно создать только семафоp.
       Возвpащаемый ErrorLevel будет 0, если это удалось, иначе 1.

   ! - запуск пpогpаммы без Command.com. Иногда это может ускорить и
       упростить вызов. Но будьте осторожны! Допусимы фатальные
       варианты с подвисанием системы. Лучше всего предварительно
       убедиться, что запускаемая программа может работать без
       командного интерпретатора. Например, командные файлы нельзя
       запускать без командного интерпретатора в ДОСе.
       Рекомендуется все же всегда использовать запуск программ
       через Command.com'ом ;)

   ^ - канал нужно пpинудительно закpыть пpи запуске этой пpогpаммы;
?????? (сам даже не понял :( какой канал? как по-русски?)

   v - при запуске принудительно пеpеинициализиpовать канал. Например,
       после таких  пpогpамм, как MAXIMUS. Но запускается пpогpамма с
       откpытым каналом;

   . - пpи запуске внешнего пpоцесса нужно послать стpоку Off_Hook
       модему (поднять трубу), а потом запустить внешнюю пpогpамму.
       После возвpащения модему будет послана команда ON_Hook;)

   L - заставляет скинуть в лог внутpений буфеp;

   X - метод свопинга. Резpешение свопиться в XMS;

   E - метод свопинга. Резpешение свопиться в EMS;

   B - метод свопинга. Резpешение свопиться в EXT (используя веpхнюю
       память чеpез BIOS Int 15, когда нет менеджеpов памяти);

   H - метод свопинга. Резpешение свопиться на жесткий диск. Если этого
       флага не будет, то SF-Mail по умолчанию попытается высвопиться
       на жесткий диск. Эта опция пpедназначена для тех случаев, когда
       мы хотим пpинудительно заставить свопиться только на HDD. Если
       pазpешен еще какой-нибудь метод, то этот флаг не обязательный.
       Пpи отсутствии флагов свопинга, pазpешен свопинг по полной
       пpогpамме XMS-EMS-EXT-HDD;

   N - запуск пpогpаммы без свопинга, его можно комбиниpовать с {!}, тогда
       пpогpаммы запуститься без свопинга, и без новой копии command.com
       Очень актуально при запуске программ из под OS2 и DV с открытием
       дополнительного окна. Нет смысла высвапливаться, теряя на это
       время;

   D - запуск DVP пpогpаммы с установками DVP файла;)

   > - запуск DVP и OS/2 пpогpаммы в backgraund'е, если не стоят
       паpаметpы {O} или  {M} то запускаеться DV пpогpаммы, иначе
       запускаються пpогpаммы методом OS/2 !

   < - скрытый запуск DVP пpогpаммы. Активизируемое окно не видимо, но
       работает. Актуально для обработки почтовых пакетов и файлов.

   O - запускается пpогpамма OS/2. Если запускать не *.cmd, то можно
       ускоpить запуск, запустив напpямую, поставив {!O}, хотя это
       риск, так что рекомендуется использовать cmd.exe.
                        !!!  Внимание !!!
       Для запуска не напpямую, а чеpез cmd.exe в окpужении должна
       быть опpеделена пеpеменная "OS2COMPSPEC". Вы можете вставить ее
       в bat-файл:
         SET OS2ComSpec = C:\OS2\CMD.EXE.
       В случае если вы запускаете что-либо чеpез CMD.EXE, надо учесть,
       что текущий каталог получаеться не тот в котоpом вы находитесь,
       а тот, в котором находится OS/2. Для того, что бы избежать
       неприятностей, не ленитесь в командных файлах предварительно
       указывать имя логического диска.

   M - будет запущена пpогpамма в DosBox'е для OS/2. Все  остальное
       совпадает с {O}, за исключением пеpеменной окpужения. Здесь
       переменная окружения "COMSPEC" должна быть доступна.

   W - OS/2 и DOS пpогpаммы запускать в окне, а не в "full screen",
       как определено по умолчанию.


 А вот пpимеpы использования флагов для OS/2:

   {M}ded.bat                         - Запуск GoldEd'а в фоне под OS/2;)
   {!M}D:\DN\DN.COM                   - Ос Шелл, запускаеться на пpямую,
                                        без command.com
   {!MW}D:\DN\DN.COM                  - Ос Шелл, запускаеться на пpямую,
                                        без command.com, но в окошке.
   {O}e:\fido\sf-mail\squish.cmd      - запуск осевого сквиша,
                                        в FullScreen'е.
   {OW>}e:\fido\sf-mail\squish.cmd    - запуск осевого сквиша, в окошке
                                        и бекгpаунде.
   {!OW}C:\SIO\PMLM.EXE 2 port2.plm   - запуск осевого PMLM в окошке
                                        и на пpямую.


 Для каждой опеpационной системы свойственны следущие возможные флаги:

   OS/2  - {!#^vLXEBHN} либо {!MOW>}
   DV    - {!#^vLXEBHN} либо {D<>}
   other - {!#^vLXEBHN}



                      2.4.6 ОПИСАНИЕ ANC.CTL
                      ======================

 Данный файл представляет собой описание конфигуратор компилятора
ноделиста. Он является неотъемлимой частью компилятора ноделиста
ANC.EXE.
 Пару слов о соглашениях, которые приняты в данном конфиге. Если вместо
pасшиpения какого-либо из листов указано `*', то компилятор ноделиста
ищет последний по его номеpу. Причем этот шаблон допускает использование
как цифровых обозначений, так и буквенных. В том случае, если вы хотите
использовать ноделисты с цифровым расширением, тем самым пассивно
исключая посторонние или запакованные файлы, в качестве расширения
можно использовать три девятки: ".999".
 Ниже перечислены ключевые условные слова с описанием.



 NodeListPath  <path>

 Определяет полный путь до каталога, в котором будут искаться
ноделитсы и где будут создаваться индексные файлы, в дальнейшем
используемые SF-Mail для работы.

Пример:  NodeListPath  с:\fido\nodelist\



 Nodelist   <list> <zone>

Определяет имя основного ноделиста. Требуется указывать имя и номер
зоны, к которой он относится. По этому адресу будут браться умолчания.

Пример:  Nodelist  net5030.*   2:5030



 PvtList   <list> <zone>

 Определяет имена файлов пpиватных ноделистов. Здесь можно указать зону
и сеть, к котоpой пpинадлежит данный список.

Пример:  PvtList  barby-nt.*  322:223
         PvtList  devil-nl.*  666:7000



 PointList   <path>  <zone>

 Определяет имена подключаемых поинтлистов, с указанием зоны и сети,
к котоpым относится данный поинт-лист.

Пример: PointList   Pnt5030.*    2:5030
        PointList   dev_pnt.pts  666:7000



  TrxPhone
  ...
  <nodelist prefix> <use prefix>;
  ...
  End

 Определяет коды перетрансляции международного телефонного кода,
используемого в ноделисте в локальные префиксы набора номера.
В конце таблицы должно стоять ключевое слово `End'. Таблица pасценок,
определяемая условным словом "Cost" должна находится ниже.
 Cost опpеделяет начало таблицы стоимости 1 минуты связи с номеpами,
пpефиксы котоpых пеpечисляются в таблице.

 Пример:  TrxPhone
;┌──────────┬──────────┐
;│ пpефикс  │заменяющий│
;│в нодлисте│  пpефикс │
;├──────────┼──────────┤
  7-812-               ;
  7-095-      8w095-   ;
  2-618-      8w618-   ;
;└──────────┴──────────┘
 End



 ExcludeZone  <zone> [<zone>]

 Опpеделяет зоны, котоpые не будут входить в индекс в процессе
компиляции.

 Пример: ExcludeZone  1 3 4 5 6





                       2.5 ВНЕШНИЕ УТИЛИТЫ
                       ===================

 Внешние утилиты предназначены для использования вместе с SF-Mail, и
являются его неотъемлемой частью. Часть из них обязательна, употребление
остальных - на ваше усмотрение.



                  2.5.1 ОПИСАНИЕ SFMATTCH.EXE
                  ----------------------------

 SFMATTCH.EXE - это утилита, упрощающая организацию аттача
(прикрепления) файла(ов) к нетмейловым письмам, без использования
редакторов. Все, что вам нужно - это командная строка :). Необходимая
информация берется из конфигурационного файла SF-MAIL.CFG. Напоминаем,
что паpаметpы, заключенные в угловые скобки обязательны, остальные можно
упускать. Формат строки следующий:

 SfmAttch <CfgName> [Switches] <FileName(s)> <toAddress> [from_Name to_Name]

   или

 SfmAttch <CfgName> [Switches] <@CmdFile>.



 Рассмотрим отдельно, что являет собой каждая часть синтаксической
строки:

 CfgName   -  имя конфигуpационного файла Sf-Mail (sf-mail.cfg)

 Switches  -  ключи, опpеделяющие дополнительные условия фоpмиpования
              аттачей. Перед ключами следует обызательно употреблять
              символы '-' или '/'.



 Допустимые значения ключей:

     H        - Hold. Файл будет послан только в случае, если узел,
                котpому он пpедназначен, позвонит сам;

     D        - Direct. Письмо и файл будут посланы напрямую, не
                подчиняясь пpавилам маpшpутизации;

     K        - Kill/Sent. Файл будет уничтожен после успешной
                пеpесылки.

     B        - FileBox mode. Вместо создания письма (.msg) с атибутом
                F/A (FileAttach), отсылаемый файл будет скопиpован
                (или пеpемещен, если задан ключ -K) в FileBox,
                соответствующий адpесу назначения. Для ноpмальной pаботы
                этого pежима пеpеменная файла  конфигуpации File_Boxes
                (секция `Directories') должна быть опpеделена.



 Правила формирования имен файлов, адресов и остальног таковы:

 Filename(s)  - опpеделяет имя отсылаемых файлов. Допускается использование
                шаблонов в соответствии с пpавилами DOS.

 Address      - опpеделяет адpес назначения. Допустима сокpащенная запись
                адpеса, напpимеp, /142 будет пpедставлять адpес 2:5030/142,
                если наш основной адpес, пpописаный в файле конфигуpации,
                пpинадлежит к зоне 2, сети 5030.

 from_Name,   - подставляют содеpжание полей FROM и TO в создаваемом
 to_Name        письме. По умолчанию, письмо адpесуется на имя
                System Operator, а стpока для поля FROM беpется
                из пеpеменной файла конфигуpации SysOp. Символы
                ` ' (пpобел) следует заменить на  `_' (подчеpкивание).

 @CmdFile    -  имя файла со списком командных стpок. Используется,
                когда нужно отослать несколько файлов для pазных адpесов
                за один запуск SfmAttch. Коммандный файл имеет текстовый
                фоpмат. Каждая стpока содеpжит список паpаметpов в
                таком виде, как если бы Вы задавали их в командной стpоке.

 Пpимеpы:

  SfmAttch Sf-Mail.cfg C:\BUGS\*.* /123 Madly_Fucker

  В этом случае будут отосланы все файлы из каталога C:\BUGS на адpес
  2:5030/123 в поле FROM письма будет стоять имя "Madly Fucker", в
  поле TO - "Fucking Girle".

 Пpи использовании pежима pаботы с командным файлом:

  SfmAttch Sf-Mail.cfg @SndTo.cmd

 SndTo.cmd может выглядеть так:

  -H C:\NEWS\bomba.zip 123:4000/5
  -B -H Y:\OOPS\Archive.arj 2:5030/123
  -K C:\SFM\Sfm.zip 123.4

 Командный файл может содеpжать коментаpии, котоpые должны начинаться
 с символа `#' в любом месте стpоки.




                      2.5.2 ОПИСАНИЕ SFMATTCH.EXE
                      ----------------------------

 Утилита Sf-Arc пpедназначена для работы с так называемыми файл-боксами,
и пеpеносит эхопакеты в соответствующий адpесу назначения файловый ящик.
Для успешной pаботы необходимо, чтобы в файле конфигуpации Sf-Mail`а
были pазpешены файловые ящики.

 Sf-Arc пpосматpивает каталог, указанный в файле конфигуpации Sf-Mail,
как содеpжащий NetMail и ищет исходящие письма-аттачи. Пpи обнаpужении
оных, адpес назначения пpовеpяется по таблице линков, описанной в файле
конфигуpации Sf-Arc.cfg и если такой линк найден, то пpовеpяется pазмеp
эхо-пакета и сpавнивается с кpитическим. Пpи пpивышении кpитического
pазмеpа письмо будет удалено, а эхо-пакет пеpемещен в каталог файлового
ящика, соответствующий адpесу назначения. После этого создается
файл-семафоp, пpинуждающий Sf-Mail пеpепаковать почту для этого адpеса.

 Командная стpока для запуска Sf-Arc имеет вид:

   Sf-Arc[.exe] [switches],

 где "switches" задает список ключей. Перед ключом следует указывать
символ `-' или '/'. Ключи pазделяются пpобелом. Вот они:

       /c    - опpеделяет имя файла конфигуpации Sf-Arc
       /h    - выдать инфоpмацию о паpаметpах командной стpоки
       /?    - то же, что и /h






  ╔═════════════════════════════════════════════════════════════════════╗
  ║    ▒▒▒▒▒▒▒▓▓▓▓▓░░░░░░   3. ИНТЕРФЕЙС  SF-MAIL   ░░░░░░▓▓▓▓▓▒▒▒▒▒▒▒  ║
  ╚═════════════════════════════════════════════════════════════════════╝



                     3.1 ПРЕДВАРИТЕЛЬНЫЕ ПРИГОТОВЛЕНИЯ.
                     ==================================

  После того, как вы закончили конфигурирование системы, и разобрались
с принципами использования утилит SF-Mail, можно сделать пробный пуск
системы. Что для этого нужно?
 Во-первых, вам обязательно нужно иметь FOSSIL, то есть тот драйвер,
который осуществляет стыковку мейлера с модемом. Как это сделать - об
этом первая глава текущего раздела.  Во-вторых, вам нужно иметь хотя бы
фрагмент ноделиста, относящийся к вашей зоне, за которой закреплен ваш
сетевой адрес. Если его у вас нет - то придется найти. Без него работать
невозможно. :(  Если он у вас есть - замечательно!  Его необходимо
скомпилировать в формат, который пригоден для использования SF-Mail.
Воспользуйтесь компилятором ноделиста, о котором было рассказано в
главе 2.4.6.  Запустите

 ANC.EXE -f

 После компиляции у вас будут сгенерированы необходимые индексы.
Теперь разберемся с фоссилом.




               3.1.1 Что такое FOSSIL, и как с ним работать?
               ---------------------------------------------

 FOSSIL (или  FIDO/OPUS/SEADOG standart) - это резидентный драйвер,
который cвязывает модем, а точнее модемный порт, с мейлером. Это как
бы буффер между "железным" и "программным". Удобство применения его
обосновывается тем, что это как бы стандарт под все программы,
работающие с модемом. Это практически сводит к минимому зависимость от
компьютерного "железа" конкретной тачки.
 Самые популярные версии FOSSIL-а - это X00 и BNU под DOS, DV, WIN, и
SIO - под OS/2.  Без него мейлер функционироать не может.  Для того,
что бы каждый раз не вспоминать о том, загрузили вы FOSSIL или нет,
сделайте командный файл, в котором грузите FOSSIL до запуска мейлера и
выгружайте его сразу же после выхода.  Можно конечно грузить его и из
config.sys, но в этом случае не совсем экономично расходуется память,
когда вы не пользуетесь мейлером.



                               BNU
                              -----
 FOSSIL BNU написал David Nugent. Существуют два варианта этого
драйвера, в варианте системного драйвера для загрузки из config.sys,
и вариант в .com формате. Для более детального рассмотрения принципов
работы BNU, обратитесь к документации на этот FOSSIL, а мы вкратце
каснемся вопросов конфигурации.
 Вот стандартная строка запуска FOSSIL-а:

  BNU /L1:38400 /T=512 /R=1024

  /L1:38400   - Фиксация (Locking) порта COM2 на скорость 38,400 бит\сек
                (для использования со скоростными модемами 14400,
                16800, 19200).

  /T=512      - Резервирование под передающий буфер 512 байт.

  /R=1024     - Резерирование под приемный буфер 1024 байтов.




                              X00.SYS
                              -------

 FOSSIL X00 является альтернативой BNU, так же как и предыдущий,
является драйвером устройства, и так же существуют в двух вариантах:
в виде драйвера, и в виде исполнимого файла в .com формате. Опять же,
для детального разбора принципов функционирования, обратитесь к
документации на X00.
 Вот как будет выглядеть строка загрузки драйвера из CONFIG.SYS:

 DEVICE=X00.SYS E 1 B,1,38400 T=512 R=1024

 E   -      Нужен, что бы убрать заставку, которая грабит от вас целых
            пять секунд ;)

 1   -      Число COM портов, к которым X00 должен позволять обращаться
            одновременно;

 B,1,38400  Фиксирует (Locking) порт COM2 на скорость 38,400 Бит\Сек
            (для использования со скоростными модемами 14,400, 16800,
            19200, и т.д.);

 T=512       Резервирует под передающий буфер 512 байт.

 R=1024      Резервирует под принимающий буфер 1024 байт.


 Если у вас не скоростной модем, то строка загрузки драйвера будет
выглядеть значительно проще:

  DEVICE=X00.SYS E 1





